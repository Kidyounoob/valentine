<!-- =========================
FILE: /formal.html
========================= -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Winter Formal? ‚ùÑÔ∏è</title>
  <meta name="theme-color" content="#7dd3fc" />
  <meta name="description" content="Aiden asking Hailie to Winter Formal." />
  <style>
    :root{
      --sky1:#d9f3ff;
      --sky2:#8fd8ff;
      --sky3:#2a74b9;
      --card: rgba(255,255,255,.80);
      --stroke: rgba(255,255,255,.62);
      --shadow: 0 24px 80px rgba(0,0,0,.18);
      --text:#0b2239;
      --muted: rgba(11,34,57,.72);
      --yes:#16a34a;
      --no:#ef4444;
      --radius: 28px;
      --max: 980px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }

    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:var(--text);

      /* ‚úÖ scrolling (mobile-friendly) */
      overflow-x: hidden;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;

      background:
        radial-gradient(1100px 700px at 18% 10%, rgba(255,255,255,.65), transparent 62%),
        radial-gradient(900px 600px at 82% 22%, rgba(255,255,255,.32), transparent 60%),
        radial-gradient(900px 520px at 55% 85%, rgba(0,170,255,.20), transparent 60%),
        linear-gradient(165deg, var(--sky1) 0%, var(--sky2) 45%, var(--sky3) 100%);
      position:relative;
      isolation:isolate;
    }

    /* soft aurora glow */
    .aurora{
      position:fixed;
      inset:-25%;
      pointer-events:none;
      z-index:0;
      filter: blur(26px) saturate(1.08);
      opacity:.70;
      background:
        radial-gradient(closest-side at 30% 30%, rgba(0,255,210,.22), transparent 55%),
        radial-gradient(closest-side at 72% 35%, rgba(120,215,255,.28), transparent 58%),
        radial-gradient(closest-side at 55% 75%, rgba(170,120,255,.14), transparent 60%),
        radial-gradient(closest-side at 20% 70%, rgba(255,255,255,.14), transparent 60%);
      animation: drift 10s ease-in-out infinite alternate;
    }
    @keyframes drift{
      from{ transform: translate3d(-2%, -1%, 0) scale(1.03); }
      to{ transform: translate3d(2%, 1%, 0) scale(1.06); }
    }

    /* snow canvases */
    canvas.layer{
      position:fixed;
      inset:0;
      width:100%;
      height:100%;
      pointer-events:none;
      z-index:1;
    }
    canvas#snowBack{ z-index:1; }
    canvas#snowMid{ z-index:2; }
    canvas#snowFront{ z-index:3; }
    canvas#confetti{ z-index:6; }

    .wrap{
      min-height:100svh;
      display:grid;
      place-items:center;
      padding: 18px 14px 40px;
      position:relative;
      z-index:4;
    }

    .container{
      width:min(100%, var(--max));
      display:grid;
      gap:16px;
    }

    .card{
      background: var(--card);
      border: 1px solid var(--stroke);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 20px 18px;
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      position:relative;
      overflow:hidden;
    }

    .card::before{
      content:"";
      position:absolute;
      inset:-2px;
      border-radius: inherit;
      background: linear-gradient(135deg, rgba(255,255,255,.55), rgba(255,255,255,0));
      opacity:.40;
      pointer-events:none;
      mask: linear-gradient(#000, transparent 72%);
    }

    .hero{
      text-align:center;
      padding-top: 22px;
      padding-bottom: 22px;
    }

    .title{
      margin: 12px 0 8px;
      font-size: clamp(32px, 5.2vw, 58px);
      letter-spacing:-0.03em;
      line-height:1.04;
    }

    .sub{
      margin: 0 auto;
      max-width: 62ch;
      color: var(--muted);
      font-size: 16px;
      line-height: 1.65;
    }

    .names{
      font-weight: 950;
      color: rgba(11,34,57,.92);
    }

    .typeLine{
      display:inline-block;
      position:relative;
      margin-top: 10px;
      font-weight: 900;
      font-size: clamp(16px, 2.3vw, 20px);
      letter-spacing: -0.01em;
      padding-right: 10px;
    }
    .typeLine::after{
      content:"";
      position:absolute;
      right:0;
      top:.12em;
      width: 2px;
      height: 1.05em;
      background: rgba(11,34,57,.70);
      animation: blink 900ms steps(1) infinite;
    }
    @keyframes blink{ 50%{ opacity:0; } }

    .emojiRow{
      margin: 14px auto 6px;
      font-size: clamp(38px, 6vw, 72px);
      line-height:1.1;
      filter: drop-shadow(0 18px 30px rgba(0,0,0,.12));
    }

    .btnRow{
      margin-top: 16px;
      display:flex;
      justify-content:center;
      gap:12px;
      flex-wrap:wrap;
      align-items:center;
    }
    button{
      border:0;
      border-radius: 16px;
      padding: 12px 18px;
      font-size: 16px;
      font-weight: 950;
      cursor:pointer;
      box-shadow: 0 14px 34px rgba(0,0,0,.16);
      transition: transform 120ms ease, opacity 120ms ease, box-shadow 120ms ease;
      user-select:none;
    }
    button:active{ transform: translateY(1px) scale(.99); }

    .yes{ background: var(--yes); color:#fff; }
    .no{ background:#fff; color: var(--no); border: 2px solid rgba(239,68,68,.22); }

    .result{
      display:none;
      margin: 14px auto 0;
      padding: 14px 14px;
      border-radius: 18px;
      background: rgba(255,255,255,.80);
      border: 1px solid rgba(255,255,255,.62);
      max-width: 70ch;
      text-align:center;
    }
    .result strong{ font-size: 18px; display:block; letter-spacing:-0.01em; }
    .result span{ display:block; margin-top: 6px; color: var(--muted); line-height: 1.6; }

    .grid{
      display:grid;
      gap:16px;
      grid-template-columns: 1fr 1fr;
      align-items:stretch;
    }
    @media (max-width: 900px){
      .grid{ grid-template-columns: 1fr; }
    }

    .imgCard{
      padding: 14px;
      display:grid;
      gap:10px;
    }

    .photo{
      width:100%;
      border-radius: 20px;
      border: 1px solid rgba(255,255,255,.7);
      background: rgba(255,255,255,.55);
      box-shadow: 0 18px 48px rgba(0,0,0,.14);
      max-height: 360px;
      object-fit: contain;
      transform: translateZ(0);
      transition: transform 180ms ease;
    }
    .photo:hover{ transform: scale(1.01); }

    .back{
      margin-top: 12px;
      display:inline-block;
      text-decoration:none;
      color: rgba(11,34,57,.70);
      font-size: 13px;
    }
    .back:hover{ text-decoration:underline; }

    /* subtle sparkles */
    .sparkle{
      position:fixed;
      width:4px;height:4px;
      border-radius:999px;
      background: rgba(255,255,255,.92);
      opacity:0;
      z-index:3;
      pointer-events:none;
      filter: drop-shadow(0 10px 20px rgba(255,255,255,.45));
      animation: sparkle 1.8s ease-out forwards;
    }
    @keyframes sparkle{
      0%{ opacity:0; transform: scale(.6); }
      15%{ opacity:.9; }
      100%{ opacity:0; transform: scale(1.9); }
    }

    @media (prefers-reduced-motion: reduce){
      .aurora{ animation:none; }
      .typeLine::after{ display:none; }
      .photo{ transition:none; }
    }
  </style>
</head>

<body>
  <div class="aurora" aria-hidden="true"></div>

  <canvas class="layer" id="snowBack" aria-hidden="true"></canvas>
  <canvas class="layer" id="snowMid" aria-hidden="true"></canvas>
  <canvas class="layer" id="snowFront" aria-hidden="true"></canvas>
  <canvas class="layer" id="confetti" aria-hidden="true"></canvas>

  <div class="wrap">
    <main class="container" role="main" aria-label="Winter Formal page">
      <section class="card hero">
        <div class="emojiRow" aria-hidden="true">üíê‚ùÑÔ∏è‚ú®</div>

        <h1 class="title">
          <span class="names">Hailie</span>, will you go to
          <span class="names">Winter Formal</span> with me?
        </h1>

        <p class="sub">
          From <span class="names">Aiden</span> to <span class="names">Hailie</span> ‚Äî I love you.
        </p>

        <div class="typeLine" id="typeLine">Tap ‚ÄúYes‚Äù and make me the happiest ‚ùÑÔ∏è</div>

        <div class="btnRow">
          <button class="yes" id="yesBtn">Yes!!! üíô</button>
          <button class="no" id="noBtn">No üòÖ</button>
        </div>

        <div class="result" id="resultBox" aria-live="polite">
          <strong id="resultTitle"></strong>
          <span id="resultText"></span>
        </div>

        <a class="back" href="./index.html">‚Üê back</a>
      </section>

      <section class="grid">
        <section class="card imgCard">
          <img class="photo" alt="Winter Formal image 1"
               src="https://image2url.com/r2/default/images/1770002293456-c8b4a5ae-c054-44ae-9608-91c523ccce44.png" />
        </section>

        <section class="card imgCard">
          <img class="photo" alt="Winter Formal image 2"
               src="https://image2url.com/r2/default/images/1770002319538-c3b9c75b-a322-49d1-a4ae-37313ad8b61e.png" />
        </section>
      </section>
    </main>
  </div>

  <script>
    // sparkles
    (function sparkleLoop(){
      const prefersReduced = window.matchMedia("(prefers-reduced-motion: reduce)").matches;
      if (prefersReduced) return;
      setInterval(() => {
        const s = document.createElement("div");
        s.className = "sparkle";
        s.style.left = `${Math.random() * 100}vw`;
        s.style.top = `${Math.random() * 100}vh`;
        document.body.appendChild(s);
        setTimeout(() => s.remove(), 1900);
      }, 260);
    })();

    // BETTER snow: layered + soft sprites + gentle wind variation
    function createSnowSprite(radius) {
      const size = Math.ceil(radius * 6);
      const c = document.createElement("canvas");
      c.width = size;
      c.height = size;
      const ctx = c.getContext("2d");
      const cx = size / 2;
      const cy = size / 2;

      const g = ctx.createRadialGradient(cx, cy, 0, cx, cy, size / 2);
      g.addColorStop(0.0, "rgba(255,255,255,1)");
      g.addColorStop(0.22, "rgba(255,255,255,0.95)");
      g.addColorStop(0.60, "rgba(255,255,255,0.35)");
      g.addColorStop(1.0, "rgba(255,255,255,0)");
      ctx.fillStyle = g;
      ctx.beginPath();
      ctx.arc(cx, cy, size/2, 0, Math.PI * 2);
      ctx.fill();

      return c;
    }

    function setupSnow(canvas, cfg) {
      const ctx = canvas.getContext("2d");
      const state = { w: 0, h: 0, t: 0, flakes: [], sprites: [] };

      function resize() {
        const dpr = window.devicePixelRatio || 1;
        state.w = window.innerWidth;
        state.h = window.innerHeight;
        canvas.width = Math.floor(state.w * dpr);
        canvas.height = Math.floor(state.h * dpr);
        canvas.style.width = `${state.w}px`;
        canvas.style.height = `${state.h}px`;
        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
      }

      function buildSprites() {
        state.sprites = [];
        const steps = 7;
        for (let i = 0; i < steps; i++) {
          const r = cfg.minR + (i / (steps - 1)) * (cfg.maxR - cfg.minR);
          state.sprites.push(createSnowSprite(r));
        }
      }

      function rand(min, max) { return min + Math.random() * (max - min); }

      function makeFlake() {
        const r = rand(cfg.minR, cfg.maxR);
        const spriteIdx = Math.min(state.sprites.length - 1, Math.max(0,
          Math.floor(((r - cfg.minR) / (cfg.maxR - cfg.minR)) * (state.sprites.length - 1))
        ));
        return {
          x: Math.random() * state.w,
          y: Math.random() * state.h,
          r,
          vy: rand(cfg.minVY, cfg.maxVY),
          baseVx: rand(-cfg.wind, cfg.wind),
          wob: Math.random() * Math.PI * 2,
          wobSpd: rand(0.0035, 0.009),
          a: rand(cfg.minA, cfg.maxA),
          spriteIdx
        };
      }

      function init() {
        buildSprites();
        state.flakes = Array.from({ length: cfg.count }, makeFlake);
      }

      function tick() {
        state.t += 1;
        ctx.clearRect(0, 0, state.w, state.h);

        // slight glow look
        ctx.globalCompositeOperation = cfg.lighten ? "lighter" : "source-over";

        const time = performance.now() * 0.001;
        for (const f of state.flakes) {
          f.wob += f.wobSpd;

          // wind that changes slowly over time + depends on y (looks more natural)
          const windWave = Math.sin(time * 0.7 + f.y * 0.008) * cfg.windWave;
          const drift = Math.sin(f.wob) * cfg.wobble;

          f.x += f.baseVx + windWave + drift;
          f.y += f.vy;

          if (f.y > state.h + 30) {
            f.y = -20;
            f.x = Math.random() * state.w;
          }
          if (f.x < -60) f.x = state.w + 30;
          if (f.x > state.w + 60) f.x = -30;

          ctx.globalAlpha = f.a;

          const sprite = state.sprites[f.spriteIdx];
          const s = sprite.width;
          ctx.drawImage(sprite, f.x - s/2, f.y - s/2);
        }

        ctx.globalCompositeOperation = "source-over";
        requestAnimationFrame(tick);
      }

      window.addEventListener("resize", () => { resize(); init(); });
      resize(); init(); tick();
    }

    const prefersReduced = window.matchMedia("(prefers-reduced-motion: reduce)").matches;
    if (!prefersReduced) {
      setupSnow(document.getElementById("snowBack"), {
        count: 180, minR: 0.6, maxR: 1.6,
        minVY: 0.20, maxVY: 0.65,
        wind: 0.18, windWave: 0.22, wobble: 0.18,
        minA: 0.10, maxA: 0.22,
        lighten: false
      });

      setupSnow(document.getElementById("snowMid"), {
        count: 140, minR: 1.1, maxR: 2.6,
        minVY: 0.45, maxVY: 1.00,
        wind: 0.35, windWave: 0.50, wobble: 0.45,
        minA: 0.14, maxA: 0.35,
        lighten: true
      });

      setupSnow(document.getElementById("snowFront"), {
        count: 95, minR: 1.8, maxR: 3.8,
        minVY: 0.85, maxVY: 1.70,
        wind: 0.55, windWave: 0.85, wobble: 0.85,
        minA: 0.18, maxA: 0.52,
        lighten: true
      });
    }

    // confetti
    const confetti = document.getElementById("confetti");
    const cctx = confetti.getContext("2d");

    function resizeConfetti() {
      const dpr = window.devicePixelRatio || 1;
      confetti.width = Math.floor(window.innerWidth * dpr);
      confetti.height = Math.floor(window.innerHeight * dpr);
      confetti.style.width = `${window.innerWidth}px`;
      confetti.style.height = `${window.innerHeight}px`;
      cctx.setTransform(dpr, 0, 0, dpr, 0, 0);
    }
    window.addEventListener("resize", resizeConfetti);
    resizeConfetti();

    function confettiBurst() {
      const colors = ["#ffffff","#dbeafe","#93c5fd","#7dd3fc","#a5f3fc","#60a5fa","#1d4ed8"];
      const pieces = Array.from({ length: 220 }, () => ({
        x: window.innerWidth / 2,
        y: window.innerHeight * 0.28,
        vx: (Math.random() - 0.5) * 14,
        vy: Math.random() * -12 - 6,
        g: 0.38 + Math.random() * 0.25,
        s: 3 + Math.random() * 6,
        r: Math.random() * Math.PI,
        vr: (Math.random() - 0.5) * 0.35,
        a: 1
      }));

      let t = 0;
      const tick = () => {
        t += 1;
        cctx.clearRect(0, 0, window.innerWidth, window.innerHeight);

        for (const p of pieces) {
          p.vy += p.g;
          p.x += p.vx;
          p.y += p.vy;
          p.r += p.vr;
          p.a *= 0.992;

          cctx.save();
          cctx.globalAlpha = Math.max(0, p.a);
          cctx.translate(p.x, p.y);
          cctx.rotate(p.r);
          cctx.fillStyle = colors[(Math.random() * colors.length) | 0];
          cctx.fillRect(-p.s/2, -p.s/2, p.s, p.s * 1.8);
          cctx.restore();
        }

        const alive = pieces.some(p => p.y < window.innerHeight + 60 && p.a > 0.06);
        if (alive && t < 240) requestAnimationFrame(tick);
        else cctx.clearRect(0, 0, window.innerWidth, window.innerHeight);
      };
      requestAnimationFrame(tick);
    }

    // buttons
    const yesBtn = document.getElementById("yesBtn");
    const noBtn = document.getElementById("noBtn");
    const resultBox = document.getElementById("resultBox");
    const resultTitle = document.getElementById("resultTitle");
    const resultText = document.getElementById("resultText");

    function showResult(title, text) {
      resultTitle.textContent = title;
      resultText.textContent = text;
      resultBox.style.display = "block";
    }

    yesBtn.addEventListener("click", () => {
      showResult("YAYYYYY!!! üíô", "I love you.");
      yesBtn.disabled = true;
      noBtn.disabled = true;
      noBtn.style.opacity = 0.4;
      confettiBurst();
    });

    function moveNoButton() {
      const padding = 10;
      const rect = noBtn.getBoundingClientRect();
      const maxX = window.innerWidth - rect.width - padding;
      const maxY = window.innerHeight - rect.height - padding;
      const x = Math.max(padding, Math.random() * maxX);
      const y = Math.max(padding, Math.random() * maxY);

      noBtn.style.position = "fixed";
      noBtn.style.left = `${x}px`;
      noBtn.style.top = `${y}px`;
      noBtn.style.zIndex = 7;
    }
    noBtn.addEventListener("mouseenter", moveNoButton);
    noBtn.addEventListener("touchstart", (e) => { e.preventDefault(); moveNoButton(); }, { passive: false });

    // type line loop
    (function typeLoop(){
      const line = document.getElementById("typeLine");
      const msgs = [
        "Tap ‚ÄúYes‚Äù and make me the happiest ‚ùÑÔ∏è",
        "Winter Formal with you would be perfect ‚ú®",
        "Hailie‚Ä¶ I love you üíô"
      ];
      let i = 0;
      setInterval(() => {
        i = (i + 1) % msgs.length;
        line.textContent = msgs[i];
      }, 2600);
    })();
  </script>
</body>
</html>
